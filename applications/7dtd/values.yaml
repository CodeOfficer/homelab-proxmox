# thelande/7dtd Helm chart values for homelab
# Chart: https://github.com/thelande/7dtd
# Chart version: 0.5.3, App version: 0.4.7

image:
  repository: thelande/7dtd
  tag: "0.4.7"
  pullPolicy: IfNotPresent

# Node scheduling - control plane only (not GPU node)
nodeSelector:
  node-role.kubernetes.io/control-plane: "true"

tolerations:
  - key: node-role.kubernetes.io/control-plane
    operator: Exists
    effect: NoSchedule

# Pod security
podSecurityContext:
  fsGroup: 1000

# Storage - local-path for performance (game is disk-intensive)
persistentStorage:
  enabled: true
  gameFiles:
    storageClass: local-path
    size: 30Gi
  steam:
    storageClass: local-path
    size: 1Gi
  backups:
    storageClass: local-path
    size: 20Gi

# Services - LoadBalancer for external access via MetalLB
gameService:
  type: LoadBalancer
  port: 26900

webDashboardService:
  type: ClusterIP  # Access via port-forward
  port: 8080

telnetService:
  type: ClusterIP  # Internal only for auto-save CronJob
  port: 8081

# Health probes - long startup for initial download (~12GB)
startupDelaySeconds: 2700  # 45 minutes

livenessProbe:
  tcpSocket:
    port: 26900
  periodSeconds: 60
  failureThreshold: 3

readinessProbe:
  tcpSocket:
    port: 26900
  periodSeconds: 60
  failureThreshold: 2

# Resources
resources:
  requests:
    memory: "4Gi"
    cpu: "2"
  limits:
    memory: "8Gi"
    cpu: "4"

# Server identification
serverName: "Homelab 7DTD"
serverDescription: "Private Homelab Server"
serverWebsiteURL: ""
serverPassword: ""  # Set password if needed

# Network
serverPort: 26900
serverMaxPlayerCount: 8
serverVisibility: 1  # 0=not listed, 1=friends, 2=public

# World settings
gameWorld: "Navezgane"  # Or "RWG" for random gen
worldGenSeed: "homelab"
worldGenSize: 6144

# Gameplay
gameDifficulty: 2  # 0-5 scale
dayNightLength: 60
bloodMoonFrequency: 7

# Performance tuning
maxSpawnedZombies: 64
maxSpawnedAnimals: 50

# Built-in backups
backups:
  enabled: true
  frequency: 30  # Every 30 minutes
  maxBackups: 48  # ~24 hours of backups

# Admin interfaces - nested under serverConfig.admin
serverConfig:
  admin:
    webDashboardEnabled: true
    webDashboardPort: 8080
    telnetEnabled: true
    telnetPort: 8081
    telnetPasswordSecret: "sdtd-telnet"  # K8s secret with 'password' key
